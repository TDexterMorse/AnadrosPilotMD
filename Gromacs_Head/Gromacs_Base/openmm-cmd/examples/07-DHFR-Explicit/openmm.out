
>>> ###################################################################
>>> # To use this script, paste all of the lines starting with the
>>> # three greater than signs (>>>) into a python interpreter.
>>> ###################################################################
>>> 
>>> from simtk.unit import *
>>> from simtk import openmm as mm
>>> from simtk.openmm import app
>>> 
>>> pdb = app.PDBFile('dhfr.pdb')
>>> topology = pdb.topology
>>> positions = pdb.positions
>>> forcefield = app.ForceField('amber99sb.xml', 'tip3p.xml')
>>> system = forcefield.createSystem(topology,nonbondedMethod=PME,constraints=HBonds
... ,rigidWater=True,nonbondedCutoff=0.9*nanometer,useDispersionCorrection=True,ewal
... dErrorTolerance=0.0005)
########################################################################
# Option Summary. A more detailed config file is saved to config.out.ini
########################################################################

[General]                       
protein = amber99sb              # your selection
water = TIP3P                    # your selection
platform = CUDA                  # your selection
coords = dhfr.pdb                # your selection
precision = Mixed                # default value
device = 2                       # your selection

[System]                        
nb_method = PME                  # default value
constraints = HBonds             # default value
rigid_water = True               # default value
rand_vels = True                 # default value
disp_corr = True                 # default value
ewald_tol = 0.0005               # default value
cutoff = 0.9*nanometer           # your selection
gen_temp = 300*kelvin            # default value

[Dynamics]                      
integrator = Langevin            # default value
dt = 2*femtosecond               # default value
barostat = None                  # default value
thermostat = None                # default value
temp = 300*kelvin                # default value
collision_rate = 1.0/picosecond  # default value

[Simulation]                    
n_steps = 100000                 # your selection
restart_file = restart.p         # default value
minimize = True                  # default value
restart_freq = 5000              # default value
traj_file = output.dcd           # default value
read_restart = False             # default value
progress_freq = 1000             # default value
write_restart = True             # default value
traj_freq = 1000                 # default value

>>> integrator = mm.LangevinIntegrator(300*kelvin, 1.0/picosecond, 2*femtosecond)
>>> platform = mm.Platform.getPlatformByName('CUDA')
>>> platformProperties = {'CudaPrecision': 'mixed', 'CudaDeviceIndex': '2'}
>>> simulation = app.Simulation(topology, system, integrator, platform, properties)
>>> simulation.context.setPositions(positions)
>>> simulation.minimizeEnergy()
>>> simulation.context.setVelocitiesToTemperature()
>>> simulation.reporters.append(ProgressReporter(sys.stdout, 1000, 100000))
>>> simulation.reporters.append(DCDReporter(output.dcd, 1000))
>>> simulation.reporters.append(RestartReporter(restart.p, 5000))
>>> simulation.step(100000)


Progress   WallTime Left      Speed          Time            P.E.            K.E.        Total E.          Temp        Vol        Rho
     (%)       (d:h:m:s)   (ns/day)          (ps)        (kJ/mol)        (kJ/mol)        (kJ/mol)           (K)     (nm^3)     (g/mL)
  0.000%              ??       0.00       0.00000   -377910.88656     60827.00583   -317083.88073     302.42445   240.9902     0.9957
  1.000%            9:47      29.13       2.00000   -311601.70059     54183.52557   -257418.17502     269.39387   240.9902     0.9957
  2.000%            7:33      37.32       4.00000   -301086.27317     58529.47738   -242556.79579     291.00142   240.9902     0.9957
  3.000%            6:56      40.27       6.00000   -296934.97220     59499.74068   -237435.23152     295.82545   240.9902     0.9957
  4.000%            6:30      42.53       8.00000   -296814.93879     60147.77542   -236667.16337     299.04740   240.9902     0.9957
  5.000%            6:15      43.75      10.00000   -296756.04306     60137.45219   -236618.59088     298.99607   240.9902     0.9957
  6.000%            6:39      40.67      12.00000   -296171.26173     60303.25884   -235868.00290     299.82044   240.9902     0.9957
  7.000%            6:22      41.98      14.00000   -296973.92251     60494.51386   -236479.40864     300.77134   240.9902     0.9957
  8.000%            6:10      42.91      16.00000   -296394.61764     60604.27663   -235790.34101     301.31706   240.9902     0.9957
  9.000%            5:59      43.77      18.00000   -296865.84302     59650.41846   -237215.42456     296.57460   240.9902     0.9957
 10.000%            5:50      44.35      20.00000   -297359.66165     60203.01666   -237156.64499     299.32205   240.9902     0.9957
 11.000%            6:03      42.32      22.00000   -297627.88158     59974.43400   -237653.44759     298.18556   240.9902     0.9957
 12.000%            5:53      43.01      24.00000   -297464.21722     60564.44426   -236899.77296     301.11902   240.9902     0.9957
 13.000%            5:45      43.48      26.00000   -297019.07994     60882.00049   -236137.07945     302.69787   240.9902     0.9957
 14.000%            5:38      43.91      28.00000   -297188.87797     61157.50805   -236031.36993     304.06766   240.9902     0.9957
 15.000%            5:31      44.25      30.00000   -297135.98710     60272.83574   -236863.15137     299.66918   240.9902     0.9957
 16.000%            5:37      42.97      32.00000   -297840.14490     59917.05051   -237923.09439     297.90026   240.9902     0.9957
 17.000%            5:30      43.43      34.00000   -298078.83595     60058.85497   -238019.98099     298.60529   240.9902     0.9957
 18.000%            5:23      43.75      36.00000   -297437.59030     60287.52019   -237150.07011     299.74219   240.9902     0.9957
 19.000%            5:17      44.12      38.00000   -296473.22014     60331.67761   -236141.54253     299.96173   240.9902     0.9957
 20.000%            5:11      44.34      40.00000   -296283.64948     59398.76996   -236884.87951     295.32343   240.9902     0.9957
 21.000%            5:14      43.34      42.00000   -297646.39879     60158.99815   -237487.40064     299.10319   240.9902     0.9957
 22.000%            5:08      43.62      44.00000   -297375.78094     60499.19569   -236876.58525     300.79461   240.9902     0.9957
 23.000%            5:03      43.86      46.00000   -296639.35693     60035.48999   -236603.86694     298.48913   240.9902     0.9957
 24.000%            4:57      44.15      48.00000   -297670.46986     60760.94952   -236909.52034     302.09602   240.9902     0.9957
 25.000%            4:52      44.30      50.00000   -296688.62725     61051.96335   -235636.66389     303.54291   240.9902     0.9957
 26.000%            4:53      43.51      52.00000   -296045.77170     60198.15305   -235847.61865     299.29787   240.9902     0.9957
 27.000%            4:48      43.75      54.00000   -296458.47119     60029.39602   -236429.07516     298.45883   240.9902     0.9957
 28.000%            4:43      43.92      56.00000   -296812.33591     60161.54240   -236650.79351     299.11584   240.9902     0.9957
 29.000%            4:37      44.17      58.00000   -296581.53623     60100.98187   -236480.55437     298.81474   240.9902     0.9957
 30.000%            4:32      44.33      60.00000   -295911.52477     60905.97003   -235005.55474     302.81705   240.9902     0.9957
 31.000%            4:32      43.83      62.00000   -295932.69526     60397.63396   -235535.06130     300.28966   240.9902     0.9957
 32.000%            4:26      44.07      64.00000   -297232.60466     60527.20566   -236705.39900     300.93388   240.9902     0.9957
 33.000%            4:21      44.29      66.00000   -295625.09813     60031.92908   -235593.16905     298.47142   240.9902     0.9957
 34.000%            4:16      44.51      68.00000   -296935.79225     60305.49529   -236630.29695     299.83156   240.9902     0.9957
 35.000%            4:11      44.70      70.00000   -297843.27907     60861.05965   -236982.21941     302.59376   240.9902     0.9957
 36.000%            4:09      44.32      72.00000   -297528.19075     60572.31269   -236955.87805     301.15814   240.9902     0.9957
 37.000%            4:04      44.51      74.00000   -297033.32137     59718.56406   -237314.75731     296.91341   240.9902     0.9957
 38.000%            4:00      44.63      76.00000   -297309.38712     60494.09166   -236815.29546     300.76924   240.9902     0.9957
 39.000%            3:55      44.79      78.00000   -297613.55925     59779.55654   -237834.00272     297.21666   240.9902     0.9957
 40.000%            3:50      44.93      80.00000   -297283.97834     60147.18734   -237136.79100     299.04447   240.9902     0.9957
 41.000%            3:50      44.30      82.00000   -297197.86162     60378.94853   -236818.91309     300.19676   240.9902     0.9957
 42.000%            3:45      44.46      84.00000   -297675.09948     61067.66975   -236607.42973     303.62100   240.9902     0.9957
 43.000%            3:40      44.61      86.00000   -295919.51070     60263.22715   -235656.28355     299.62141   240.9902     0.9957
 44.000%            3:36      44.78      88.00000   -297856.57024     59947.76671   -237908.80353     298.05298   240.9902     0.9957
 45.000%            3:31      44.86      90.00000   -297617.87338     59998.99656   -237618.87683     298.30769   240.9902     0.9957
 46.000%            3:29      44.44      92.00000   -297070.53430     60665.24544   -236405.28887     301.62019   240.9902     0.9957
 47.000%            3:25      44.55      94.00000   -296992.68060     61154.74495   -235837.93565     304.05393   240.9902     0.9957
 48.000%            3:21      44.65      96.00000   -296487.23462     59479.78752   -237007.44711     295.72624   240.9902     0.9957
 49.000%            3:16      44.77      98.00000   -297462.54232     60164.81214   -237297.73018     299.13210   240.9902     0.9957
 50.000%            3:12      44.84     100.00000   -297346.85802     60182.22996   -237164.62805     299.21870   240.9902     0.9957
 51.000%            3:10      44.38     102.00000   -297300.42972     60220.84555   -237079.58418     299.41069   240.9902     0.9957
 52.000%            3:06      44.47     104.00000   -296939.00231     60724.84121   -236214.16110     301.91650   240.9902     0.9957
 53.000%            3:02      44.59     106.00000   -297045.27620     60446.87640   -236598.39980     300.53449   240.9902     0.9957
 54.000%            2:57      44.71     108.00000   -296949.66617     61473.56504   -235476.10113     305.63906   240.9902     0.9957
 55.000%            2:53      44.80     110.00000   -298260.77489     60346.85928   -237913.91561     300.03722   240.9902     0.9957
 56.000%            2:51      44.42     112.00000   -296259.29975     60620.54925   -235638.75050     301.39797   240.9902     0.9957
 57.000%            2:46      44.53     114.00000   -297334.95580     60853.06336   -236481.89244     302.55400   240.9902     0.9957
 58.000%            2:42      44.62     116.00000   -296047.38665     59801.76010   -236245.62655     297.32705   240.9902     0.9957
 59.000%            2:38      44.73     118.00000   -297237.90816     59901.39362   -237336.51454     297.82242   240.9902     0.9957
 60.000%            2:34      44.80     120.00000   -296793.29733     60646.08319   -236147.21413     301.52492   240.9902     0.9957
 61.000%            2:31      44.37     122.00000   -295888.07156     60449.40228   -235438.66928     300.54705   240.9902     0.9957
 62.000%            2:27      44.48     124.00000   -295818.26961     60701.85671   -235116.41290     301.80222   240.9902     0.9957
 63.000%            2:23      44.55     126.00000   -296905.69042     60892.02344   -236013.66698     302.74771   240.9902     0.9957
 64.000%            2:19      44.66     128.00000   -296492.74967     59861.95531   -236630.79436     297.62633   240.9902     0.9957
 65.000%            2:15      44.72     130.00000   -297080.24586     60613.65612   -236466.58975     301.36370   240.9902     0.9957
 66.000%            2:12      44.36     132.00000   -296717.08567     59419.63667   -237297.44900     295.42718   240.9902     0.9957
 67.000%            2:08      44.44     134.00000   -298050.21463     60244.73732   -237805.47731     299.52948   240.9902     0.9957
 68.000%            2:04      44.55     136.00000   -296908.02067     60031.59899   -236876.42168     298.46978   240.9902     0.9957
 69.000%            2:00      44.63     138.00000   -297478.44569     59752.37302   -237726.07267     297.08150   240.9902     0.9957
 70.000%            1:55      44.70     140.00000   -297442.21782     60630.33208   -236811.88574     301.44661   240.9902     0.9957
 71.000%            1:53      44.32     142.00000   -297602.89302     60647.88844   -236955.00459     301.53390   240.9902     0.9957
 72.000%            1:49      44.38     144.00000   -298006.03639     60421.59110   -237584.44529     300.40877   240.9902     0.9957
 73.000%            1:44      44.45     146.00000   -297958.38579     59688.23180   -238270.15399     296.76260   240.9902     0.9957
 74.000%            1:40      44.54     148.00000   -297440.70108     59892.93189   -237547.76920     297.78034   240.9902     0.9957
 75.000%            1:36      44.58     150.00000   -297495.70565     60422.56207   -237073.14358     300.41360   240.9902     0.9957
 76.000%            1:33      44.26     152.00000   -296637.54793     60567.10476   -236070.44317     301.13225   240.9902     0.9957
 77.000%            1:29      44.36     154.00000   -296099.87270     60838.58040   -235261.29230     302.48199   240.9902     0.9957
 78.000%            1:25      44.44     156.00000   -297576.00823     60453.36717   -237122.64106     300.56676   240.9902     0.9957
 79.000%            1:21      44.53     158.00000   -297729.49938     60577.66327   -237151.83611     301.18475   240.9902     0.9957
 80.000%            1:17      44.61     160.00000   -296410.35438     60494.31938   -235916.03500     300.77037   240.9902     0.9957
 81.000%            1:13      44.43     162.00000   -296084.25388     60120.31917   -235963.93470     298.91089   240.9902     0.9957
 82.000%            1:09      44.50     164.00000   -297050.66595     60552.38228   -236498.28367     301.05905   240.9902     0.9957
 83.000%            1:05      44.59     166.00000   -297075.59147     60393.08894   -236682.50253     300.26706   240.9902     0.9957
 84.000%            1:01      44.67     168.00000   -297269.70643     60512.63124   -236757.07518     300.86141   240.9902     0.9957
 85.000%            0:57      44.74     170.00000   -296238.56719     60708.77448   -235529.79271     301.83661   240.9902     0.9957
 86.000%            0:54      44.55     172.00000   -296440.55059     59819.67603   -236620.87456     297.41613   240.9902     0.9957
 87.000%            0:50      44.63     174.00000   -297507.03522     60424.71582   -237082.31940     300.42431   240.9902     0.9957
 88.000%            0:46      44.70     176.00000   -297244.99686     60230.34652   -237014.65034     299.45793   240.9902     0.9957
 89.000%            0:42      44.77     178.00000   -298058.90659     59370.95224   -238687.95435     295.18513   240.9902     0.9957
 90.000%            0:38      44.82     180.00000   -297751.16584     60298.13779   -237453.02804     299.79498   240.9902     0.9957
 91.000%            0:34      44.61     182.00000   -297354.95274     60307.86502   -237047.08771     299.84334   240.9902     0.9957
 92.000%            0:30      44.68     184.00000   -296901.63609     59754.47344   -237147.16265     297.09195   240.9902     0.9957
 93.000%            0:27      44.75     186.00000   -296715.74657     60350.68756   -236365.05901     300.05625   240.9902     0.9957
 94.000%            0:23      44.82     188.00000   -296386.66158     59782.53623   -236604.12536     297.23147   240.9902     0.9957
 95.000%            0:19      44.85     190.00000   -296456.26917     60237.19633   -236219.07284     299.49199   240.9902     0.9957
 96.000%            0:15      44.66     192.00000   -296280.64519     59809.68049   -236470.96470     297.36643   240.9902     0.9957
 97.000%            0:11      44.71     194.00000   -297088.09636     59208.29648   -237879.79988     294.37642   240.9902     0.9957
 98.000%            0:07      44.77     196.00000   -297674.65485     60231.82098   -237442.83387     299.46526   240.9902     0.9957
 99.000%            0:03      44.83     198.00000   -297221.99199     61236.30890   -235985.68309     304.45945   240.9902     0.9957
100.000%            0:00      44.88     200.00000   -297053.89288     60677.85070   -236376.04218     301.68287   240.9902     0.9957
